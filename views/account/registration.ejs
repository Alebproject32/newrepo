<!-- 
  The registration view for creating new user accounts.
  Includes HTML5 validation for all fields.
-->
<% if (title) { %>
<h1 class="registration-h1"><%= title %></h1>
<% } %>

<!-- Flash Messages container -->
<%- messages() %> <% if (errors) { %>
<ul class="notice">
  <% errors.array().forEach(error => { %>
  <li><%= error.msg %></li>
  <% }) %>
</ul>
<% } %>

<div class="registration-container">
  <form
    id="registrationForm"
    action="/account/register"
    method="post"
    class="registration-form"
  >
    <!-- First Name Field -->
    <div class="input-group">
      <label for="accountFirstName">First name:</label>
      <input
        type="text"
        id="accountFirstName"
        name="account_firstname"
        placeholder="Enter your first name"
        value="<%= locals.account_firstname || '' %>"
        required
      />
    </div>

    <!-- Last Name Field -->
    <div class="input-group">
      <label for="accountLastName">Last name:</label>
      <input
        type="text"
        id="accountLastName"
        name="account_lastname"
        required
        placeholder="Enter your last name"
        value="<%= locals.account_lastname || '' %>"
      />
    </div>

    <!-- Email Field -->
    <div class="input-group">
      <label for="accountEmail">Email address:</label>
      <input
        type="email"
        id="accountEmail"
        name="account_email"
        required
        placeholder="Enter your email address"
        title="Valid email address is required (e.g., name@example.com)"
        value="<%= locals.account_email || '' %>"
      />
    </div>

    <!-- Password Field with Validation -->
    <div class="input-group">
      <label for="accountPassword">Password:</label>

      <!-- Password Requirements Info -->
      <div class="password-requirements"></div>

      <div class="password-input-wrapper">
        <input
          type="password"
          id="accountPassword"
          name="account_password"
          required
          placeholder="Enter your password"
          pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{12,}$"
          title="Must contain at least one number, one uppercase and lowercase letter, one special character, and at least 12 or more characters"
        />
        <span class="show-hide-btn" id="passwordToggle">Show</span>
      </div>
      <strong>Password Requirements:</strong>
      <span
        >Passwords must be at least 12 characters and contain at least 1 number,
        1 capital letter, and 1 special character.</span
      >
    </div>

    <button type="submit" class="btn-register">Register</button>
  </form>
</div>

<!-- JavaScript for password toggle functionality -->
<script>
  const passwordInput = document.getElementById("accountPassword");
  const passwordToggleButton = document.getElementById("passwordToggle");

  if (passwordToggleButton && passwordInput) {
    passwordToggleButton.addEventListener("click", function () {
      if (passwordInput.type === "password") {
        passwordInput.type = "text";
        passwordToggleButton.textContent = "Hide";
      } else {
        passwordInput.type = "password";
        passwordToggleButton.textContent = "Show";
      }
    });
  }
</script>
